#-tittle: some guys security notes
* Intro to Security
** CIA: Confidentiality, Integrity, and Availability
*** Confidentiality: Prevents disclosure of info to outside party
*** Integrity: guarantees data has not been tampered with
*** Availability: resources can be accessed when needed
** AAA: Authentication, Authorization, Accounting 
*** Authentication: Confirms one's identity
**** username/password
**** biometrics
**** signature /etc
*** Authorization: Allows one to access certain materials 
**** ACL(access control lists)
**** Linux permission bits /etc
*** Accounting: Tracking of data/computer/network resources usage for individuals
**** logging
**** auditing
**** data/network monitoring
** Types of threats
*** Malicious Software
*** Unauthorized access
*** System failure
*** Social Engineering
** Physical, Technical, Administrative Security plans
*** Physical: Alarms, ID cards, CCTV etc
*** Technical: Smart cards, ACLs, encryption etc
*** Administrative: policies, procedures, DRP(Disaster recovery plan)etc
** Protection Methods 
*** user awareness
*** Authentication
*** anti-malware
*** data backups
*** encryption
*** data removal
** Good security plan + good protection method = Solid defense(defense in depth)
*** types of hackers
**** white hat
***** ethical hacker or a computer security expert, who specializes in penetration testing 
**** black hat
*****  hacker who infiltrates a computer system for malicious purposes
**** grey hat
***** hacker or computer security expert who may sometimes violate laws or typical ethical standards with no malicious intent
**** blue hat
***** bounty hunters
**** elites
***** zero day discoverers
*** type of attackers
**** script kiddie
**** hacktivist
**** organized crime
**** APT(advanced persistent threat aka nation state attacker)
* ch. 2 Computer systems security part1
** types of malware
*** viruses
**** malicious code executed by user and lives on a file 
**** boot sector: placed in first hard drive sector
**** macro: placed into documents
**** program: infects executables
**** encrypted: avoids detection through encryption
**** polymorphic:decryption module changes with every infection
**** metamorphic: whole virus code changes with every infection
**** stealth
**** armored: misdirects antivirus away from its actual location
**** Multipartite : hybrid of boot sector and program
*** worms
**** malicious code that replicates, standalone program, may spread automatically
*** trojans
**** appear to be beneficial but contain malicious code
**** keygens
**** RAT trojans
*** ransomware
**** encrypts files and data and demands payment to unlock
**** often propagates as a trojan or worm
*** spyware
**** usually hidden inside third party applications
**** logs various user activities and sends it to attacker
**** associated with adware and grayware
** malware delivery
*** threat vector vs attack vector
*** software, messaging, and media
**** emails, ftp, P2P/torrent file downloads
**** removable media
*** typosquatting 
*** exploit kit
*** botnets and zombies
**** for DDos or financial gain
*** active interception(MITM)
*** privilege escalation
*** backdoor
**** authentication bypass mechanisms built into the program itself
*** logic bombs
**** triggers malware on certain condition(data,OS, etc)
** malware prevention / troubleshooting
*** common symptoms: slow comp speed, crashes, incorrect home page, pop ups
*** common prevention
**** antivirus: regular updates and scans
***** finds: worms, viruses and trojans
***** does not find: botnet activity, rootkits,logic bombs
**** firewalls and regular OS updates
**** separation of OS and data
**** hardware + software based firewall
***** router + windows firewall
**** encryption for confidentiality (windows EFS)
*** common steps to malware removal
**** Identify Symptoms
**** quarantine infected system / drive / file
**** disable system restore
**** remediate affected system
***** update AV / scan and removal
**** schedule scans and run updates
**** enable system restore and set new restore point
**** educate end user
*** worms and trojans
**** antivirus, regular maintenance and vigilance
*** spyware
**** antivirus, rootkit detectors
**** use UEFI over BIOS (GPT over MBR)
**** wipe the entire drive and reinstall os
*** spam 
**** spam filter 
**** whitelisting/blacklisting
**** close open mail relays
* ch.3 computer system security part2
** security app
*** personal firewalls
**** windows firewall
**** zone alarm
**** packet filter and ip firewall(mac)
**** iptables (linux)
*** IDS(Intrusion Detection System) 
**** host based: loaded onto individual machine
***** analyzes and monitors that one machine state
***** can interpret encrypted traffic
**** network based: on machine or standalone device
***** monitors ever packet going through network interface
***** monitors multiple devices and less expensive
***** cannot monitor what happens in an OS
**** monitoring types
***** Statistical Anomaly
****** makes baseline and compared current performance
***** signature
****** network traffic analyzed to find predetermined patterns
**** HIDS examples
***** Trend micro OSSEC (freeware)
***** Verisys (commercial, windows)
***** Tripwire (commercial)
**** Protect HIDS database with encryption and access control
*** popup blockers
**** ad filtering and content filtering
*** DLP(data loss prevention)
**** monitors data in use / in motion / at rest
**** prevents unauthorized use and leakage of data
**** types of DLP
***** endpoint: runs on single machine, software based
***** network: software/hardware, installed on network perimeter
***** storage: installed in data centers/server rooms
*** securing computer hardware and peripherals
**** peripherals: usb flash drives, SATA external HDD, optical disks
**** securing BIOS
***** flashing (updating) BIOS firmware
***** BIOS password
***** config BIOS boot order
***** secure boot (disable unsigned device drivers, UEFI)
*** securing storage devices
**** removable storage
***** typically prohibits all removable storage besides specific ones
***** removable media controls
***** usb lockdown(BIOS),limit usb use, malware scans, audits
**** NAS(network attached storage)
***** built for high availability 
***** commonly implemented as RAID array
***** use encryption, auth, secure logging etc
**** whole disk encryption
***** requires either self encryption or full disk encryption 
***** windows bitlocker requirements
****** TPM or external usb key with encrypted keys
****** hard drive with 2 volumes(1 for boot and 1 to be encrypted)
***** double encryption
****** bitlocker and EFS
**** HSM(hardware security modules)
***** handles mainly quick crypto functions with key storage
**** TPM:Trusted Platform Module
***** handles key storage with limited crypto function
*** securing wireless peripherals
**** force devices to use AES or WPA2 encryption for data transmission
** securing mobile devices
*** general security
**** keep phone number secure and do not respond to unsolicited calls
**** update mobile OS
**** complex password and limit downloads to device
*** malware
**** install and update mobile device AV
**** take use of built in security features
**** avoid following links and don't store info on device
**** don't post info on social media
*** botnet activity
**** follow anti-malware procedures
**** avoid rooting / jailbreaking phones
*** SIM cloning
**** cloned SIM redirects all calls and texts to its own device
**** able to hijack messages intended for original SIM card owner
*** wireless attacks
**** bluejacking
**** bluesnarfing
*** theft
**** full device encryption(FDE)
**** setup GPS tracking
**** remote lock and wipe tech
*** mobile app
**** mobile key management: use third party software(verisign)
**** app whitelisting/blacklisting
**** strong SMS app and endpoint security
**** mobile payment: avoid public networks, user education
**** geotagging : disable GPS depending on situation
**** BYOD concerns
***** storage segmentation: divide corp vs private data storage
***** mobile device management system of corporations
* ch.4 OS harding and virtualization
** OS Hardening
*** Motivation : Out of the box OS is vulnerable by default
**** Need to customize settings to make it more secure
*** Concept of Least Functionality
**** Restrict and remove any functionality not required for operation
**** NIST CM-7 control proes are now used interchangeably
***** Disable automatic updates to synchronize versions and updates
*** Patch Management
**** Process of planning, testing, implementing and auditing patches
***** Planning  : Deciding which patches are required
****** Checking Compatibility
****** Plan how the patch will be tested / deployed
***** Testing   : Test the patch on one machine / small system
***** Implement : Patch deployment to all machines
****** Use SCCM or other centralized management system
***** Auditing  : Confirm patch is live on system
****** Check for any failures or changes due to the patch
*** Group Policies, Security Templates, Configuration Baselines
**** Group Policy : Used in Windows to set group configurations
***** gpedit.msc
*** Hardening File Systems and Hard Drives
**** Use a secure file system
***** NTFS for Windows, allows encryption, ACLs, logging
***** Use chkdsk and convert commands
***** ext4 for Linux / Use fdisk â€“l or df â€“T
**** Hide important files (System files, personal etc)
**** Manage hard drives
***** Delete temp files
***** Periodically verify system files integrity
***** Defrag hard drives
***** Backup data
***** Restore points
***** Whole disk encryption
***** Separate OS system and personal data
** Virtualization 
*** Virtualization : Creation of virtual machines housed in an OS
*** VM(Virtual Machines) and VDE(Virtual Desktop Environment)
**** pro 
***** Flexible and portable
***** Safe testing of malware in a controlled environment
**** cons 
***** Resource intensive procedures
***** National Institute of Standards and Technology
**** Target features
***** Applications
***** ports 
***** Services (daemons)
**** Consider backwards compatibility when removing obsolete applications
**** SCCM (System Center Configuration Manager) for multiple machines
**** Application blacklisting / whitelisting
**** Service configuration commands
***** Windows : services.msc, net stop, sc stop
***** Linux : /etc/init.d/<service> stop, service <service> stop etc
***** OSX : kill command
*** Update, Patches, Hotfixes
**** TOS (Trusted Operating System) 
*** Certified OS considered secure by gov standards
**** Update Categories
***** Security Update : Product specific, security related
***** Critical Update : critical, non security related bug fix
***** Service Pack : Cumulative set of updates, now discontinued
***** Windows Update : Noncritical fixes, new features and updates
***** Driver Update : Beware driver shimming / refactoring
**** Hotfixes and patches are now used interchangeably
***** Disable automatic updates to synchronize versions and updates
*** Patch Management
**** Process of planning, testing, implementing and auditing patches
***** Planning  : Deciding which patches are required
****** Checking Compatibility
****** Plan how the patch will be tested / deployed
***** Testing   : Test the patch on one machine / small system
***** Implement : Patch deployment to all machines
****** Use SCCM or other centralized management system
***** Auditing  : Confirm patch is live on system
****** Check for any failures or changes due to the patch
*** Group Policies, Security Templates, Configuration Baselines
**** Group Policy : Used in Windows to set group configurations
***** gpedit.msc
*** Hardening File Systems and Hard Drives
**** Use a secure file system
***** NTFS for Windows, allows encryption, ACLs, logging
***** Use chkdsk and convert commands
***** ext4 for Linux / Use fdisk â€“l or df â€“T
**** Hide important files (System files, personal etc)
**** Manage hard drives
***** Delete temp files
***** Periodically verify system files integrity
***** Defrag hard drives
***** Backup data
***** Restore points
***** Whole disk encryption
***** Separate OS system and personal data
** Virtualization 
*** Virtualization : Creation of virtual machines housed in an OS
*** VM(Virtual Machines) and VDE(Virtual Desktop Environment)
**** pro 
***** Flexible and portable
***** Safe testing of malware in a controlled environment
**** cons 
***** Resource intensive
***** Vulnerable to hardware failures
*** VM Categories 
**** System virtual machine : Runs an entire OS
**** Process virtual machine : Runs a single application (browser)
*** Virtualization (Emulation)Simulation
*** Virtual Appliance (Image) Virtual Machine
*** Other forms of virtualization
**** VPN (Virtual Private Network)
**** VDI (Virtual Desktop Infrastructure)
**** VLAN (Virtual Local Area Network)
*** Hypervisor (Virtual Machine Manager)
**** Allows multiple virtual OS to run concurrently 
***** Type 1 hypervisor (Native)
****** Runs directly on host hardware
****** Flexible and efficient
****** Strict hardware/software restrictions, less common
***** Type 2 hypervisor (Hosted)
****** One level removed from host hardware
****** More available to most OS and hardware
****** Resource intensive
**** Application Containerization
***** Runs distributed applications w/o running an entire VM
*** Securing Virtual Machines
**** Generally equivalent to securing regular OS, but with little more work
***** 1. Update virtual machine software (e.g. VirtualBox)
***** 2. Be wary of VM-VM and VM-host network connections
***** 3. Protect NAS and SAN from virtual hosts
***** 4. Disable unnecessary USB and external ports on VMs
***** 5. Alter boot priority for virtual BIOS
***** 6. Limit and monitor VM resource usage to prevent DOS attacks
***** 7. Protect raw virtual machine image
****** Snapshots, Encryption, Access permission and signatures
**** Virtualization Sprawl : When there are too many VMs to manage at once
***** Employ a VMLM (Virtual Machine Lifecycle Management) tool
* Chapter 5 : Application Security
** Securing Web Browsers
*** Avoid newest versions and disable auto update (new versions are unstable)
*** Consider organizational requirements and OS
*** General Browser Security Procedures
**** Implement Policies
***** Hand written, browser settings, GPO(Windows), OS setting etc
**** Train Users
**** Use proxy and content filter
***** Proxy servers as an intermediate cache between server and client
***** Configured in browser settings / domain controller
***** Beware of malicious proxy configurations
**** Secure against malicious code 
**** DevOps
***** Deployment tool, often used together with Agile method
***** security Automation
***** continuous integration
****** immutable systems
******* all locked down and is a virual machine
****** infrastructure as code
******* scripts to setup the infrastructure like SDN
****** provisioning and deprovisioning
***** normalization 
****** all the baseline security code protocol 
*** Core SDLC and DevOps Principles
**** Preserving CIA of software development
**** Secure code review
***** In depth code review for security bugs
***** Included before fuzzing or penetration testing
**** Threat Modeling
***** Identifying and prioritizing potential threats
**** Common Security Principles
***** 1. Least Privilege
***** 2. Defense in Depth
***** 3. Never trust user input
***** 4. Minimizing attack surface
***** 5. Secure defaults
***** 6. Provide authenticity and integrity (program signatures)
***** 7. Fail securely (Error handling)
***** 8. Thorough testing of security fixes and patches
*** Program Testing Methods
**** White box vs Black box testing
***** white box, black box, gray box, stress testing, pentesting etc
**** Compile time vs runtime errors
***** Reminder that both software and hardware has runtime errors
***** SHE (Structured Exception Handling) deals with both SW/HW
**** Input Validation
***** Perform on both client and server side
***** Key factor of SQL injections and XSS
**** Static vs Dynamic code analysis
***** Static : No code execution, examines code with automated tools
***** Dynamic : Runtime examination of code behavior for bugs
****** fuzzing is a form of dynamic code analysis 
**** Fuzz Testing
***** Input of large amounts of random data until code errors
*** Program Vulnerability and Attacks
**** Backdoors 
***** Preprogrammed authentication bypasses built into system
***** Updates usually remove these, job rotation, code cross checking
**** Memory / buffer vulnerabilities
***** Buffer overflows (Stack, heap)
***** Integer overflows (integer wrapping)
***** Memory leaks : Degrades system performance
***** Nullptr dereference
***** ASLR and DEP is common defense against buffer overflows
**** Arbitrary and Remote Code Execution
***** Shellcode injections
***** Strong input validation, fuzz testing
**** XSS / XSRF
***** Common browser based attacks, uses HTML code injection
**** other code injections
***** SQL Injection
***** LDAP Injection
***** XML Injection 
**** directory traversal
**** zero days
* Chapter 6 : Network Design Elements
** Network Design
*** OSI Model 
**** 1 layer: Physical	=bits= Physical and Electrical medium
**** 2 layer: Data link =Frames= Establishes, maintains and decides how data transfer is accomplished over the physical layer
**** 3 layer: Network =Packets=	Routing and Switching
**** 4 layer: Transport =Segments(TCP)= Manages/ensures error free transmission between hosts through logical addressing/port assignment	
**** 5 layer: Session  Establishment, termination and synchronization of sessions within the OS over the network and between hosts messages
**** 6 layer: Presentation	Sender to receiver data translation, Code conversion, data compression and file
**** 7 layer: Application	FTP, HTTP and SMTP end user protocols	Messages 
*** Network Devices
**** Switch 
***** Central connection device, replaces hubs and bridges
***** Translates MAC and MAC+IP into physical ports to route messages
***** Attacks
****** MAC Flooding : Uses up the CAM to force switch into broadcast
****** MAC Spoofing : Masks network adapter MAC with different value
****** Physical Tampering : Vulnerable management ports, Looping
******* Use hierarchical router structure or spanning tree 
**** Bridges
***** Used to separate physical LAN into two logical networks
***** Works on layer 2 (Data link), now obsolete
**** Router
***** Used to connect two or more networks
***** Works on network 3 (Network)
***** Various forms : SOHO, servers configured as routers, Cisco black box
***** Attacks : DOS, malware intrusions etc
***** Defenses
****** Secure configurations
****** Firewalls
******  IPS
****** Secure VPN Connectivity
****** Content filtering
****** ACL (Access Control Lists)
** NAT (Network Address Translation), Private vs Public Addresses
*** NAT : Process of changing IP in transit
*** Motivation
**** Allow a large private address space mapped to a smaller public one
***** Firewall effect (hides internal IPs)
***** Static NAT : Only one machine uses the router that does NAT
**** Private IP
***** Invisible to public(internet)
***** Assigned automatically by SOHO router or DHCP server
***** Within predetermined range
**** Public IP
***** Visible to public, anyone can attempt connection
***** Assigned by ISP DHCP servers
**** IPv6 Vulnerability
***** By default attempts to automatically connect to other IPv6 addresses
***** Make sure to secure both IPv4 and IPv6
** Network Zones and Interconnections
**** LAN (Local Area Network)
***** Group of interconnected computers contained in a small space
***** Usually uses private IPs behind a firewall
***** By default does not have internet access, but may connect to an Internet proxy to do so
**** WAN (Wide Area Network)
***** Network of two or more interconnected LANS
***** Covers a larger geographical area
***** Requires telecomm/datacomm service company
**** Internet
***** Worldwide interconnected network
***** Must secure all transmission that happens over the internet
**** DMZ (Demilitarized Zone)
***** Special subnetwork designed for external client access
***** Common web/FTP/email/database etc services reside in DMZ
***** Can also be accessed by LAN clients
***** Often placed in a separate LAN network from the rest of system
***** Common 3-leg perimeter configuration
**** Intranets & Extranets
***** Used to share company data securely through the internet
***** One company = intranet, multiple companies involved = extranet
***** Never store confidential + data in these networks
***** Crucial to properly implement firewall
*** NAC (Network Access Control)
**** Denies network access until client obtains proper security measures
**** Antivirus, system updates etc
**** Preinstalled client side software (agent) or remote scan (agentless)
**** Persistent vs Dissolvable agents
***** Persistent : Designed for multiple use
***** Dissolvable : Designed for one time authentication
**** Agentless offers less control for more flexibility
**** Cisco offers hardware solutions
*** Subnetting
**** Process of creating logical subnetworks through IP manipulation
**** Benefits
***** Compartmentalizes network, increasing security
***** Efficient use of IP address
***** Reduces IP collision and broadcast signals
**** Overview
***** Class A : Large network, 255.0.0.0
***** Class B : Medium network, 255.255.0.0
***** Class C : Small network, 255.255.255.0
***** Example : 192.168.1.0/28   28 is total number of bits used
*** Class C Network
**** 255.255.255.240  1111 1111 . 1111 1111 . 1111 1111 . 1111 0000
**** First 3 octets are Class C mask
**** First 4 bits of last octet is subnet mask, 2^4 = 16 subnets
**** Last 4 bits of last octet is host ID, 2^4-2 = 14 hosts
*** VLAN(Virtual LAN)
**** Segments various networks sharing the same switch, reduce collision,Organize network, boost performance and security
**** Works on Layer 2 (Data link frames)
**** Allows admins to group hosts connected on different switches together
**** VLAN Hopping : Methods of gaining access to other VLANs on switch 
***** Switch Spoofing
***** Double Tagging
*** Telephony
**** Provides voice communications, fax etc
**** Now computers are involved in telephony as CTI
**** Modems
***** Still often used to connect to networking equip. via dial up
***** Very insecure (War dialing)
***** Protections : Callback, username/pw, hide modem number
*** PBX(Private Branch Exchange)
**** Makes internal phone connections, connects to PSTN
**** New added features now make them less secure
*** VoIP
**** Broad term for voice data over IP networks
**** IP phones exploited the same way as regular computers
**** Home VoIP solutions use SIP(Session Initiation Protocol) vulnerable to MiTM Cloud Security and Server Defense
*** Definition of Cloud : Any network between two organization borders
*** Cloud Computing
**** A method of offering on demand services normal users donâ€™t have
**** SaaS (Software as a Service)
***** Allows user to have access to software they donâ€™t have on host
**** IaaS (Infrastructure as a Service)
***** Offers networking, routing, VM hosting and other networking
**** PaaS (Platform as a Service)
***** Offers virtual development of application
**** SECaaS (Security as a Service)
***** Offers security services to be integrated into existing infra.
*** Different Types of Cloud
**** Public Cloud : Full public access, low security
**** Private Cloud : Full private access, high security
**** Hybrid Cloud : Utilize both private and public depending on handled data
**** Community Cloud : Private to specific group, good for collab projects
*** Cloud Security
**** Depends on the amount of security control the admin has
**** Defenses for sending data to cloud
***** Passwords : 10 char general case, 15 for confidential data
***** Multifactor authentication
***** Strong data access policy : passwords, multifactor, group policy
***** Encryption : strong PKI encryption on all files 
***** Programming standardization
***** Data protection
***** Unconventional data channels : Social media, P2P, dark net
*** Server Defenses
**** Servers are most important part of network to secure
**** Contains all data and services
***** File Servers
****** Stores, transfer, migrate, synchronize and archive files
****** Identical vulnerability to malware that target desktop PCs
****** Hardening, updates, AV, SW/HW firewall, HIDS, encryption, monitoring
***** Network Controllers
****** Central repo of all user and computer accounts
****** LDAP injection, Kerberos vulnerabilities  privilege escalation
****** Updates, hot fixes
***** Email Servers
****** Deals with email, texting, fax, chat etc
****** May run multiple services and ports, POP3, SMTP, IMAP, Outlook
****** XSS, DDOS, SMTP memory exploits, directory traversal etc
****** Updates, quarantine, HW/SW spam filter, DLP, encryption (TLS/SSL) 
***** Web Servers
****** Provide web and website services to users
******* Ex) Microsoft IIS, Apache HTTP, lighthttp, Oracle iPlanet
****** DDOS, overflow attacks, XSS, XSRF, remote code exec., backdoors
****** Secure programming, updates, HW firewall, HTTPS
****** * Darkleech : Apache based attack using malicious Apache modules
***** FTP Servers 
****** Basic file access (public/private)
****** Web shells, weak authentication, bounce attacks, buffer overflow
****** Strong password, secure encrypted FTP, dynamic port assignment
* Chapter 7 : Networking Protocols and Threats
** Ports and Protocols
*** Port Ranges, Inbound vs Outbound, Common Ports
**** Ports : Logical communication endpoints
**** TCP vs UDP
***** TCP : Ordered, guaranteed connection oriented sessions
***** UDP : Unordered, streaming real time connection
**** Total of 65536 ports
**** Port Ranges
**** Inbound vs Outbound Port
***** Inbound : Usually leaves well known ports on server open Needs to be secured by an Admin
***** Outbound : Used to initiate connections to servers
**** Dynamic Port assignment enhances security
**** Well Known Ports
***** 21	FTP	TCP	FTPS, 989/990	Transfer Files from host to host
***** 22	SSH	TCP/UDP		Secure Shell Connection
***** 23	Telnet	TCP/UDP		Remote administration (deprecated)
***** 25	SMTP	TCP	SMTP w/ TLS, 465/587	Sends Email
***** 49	TACACS+	TCP		Remote Authentication
***** 53	DNS	TCP/UDP	DNSSEC	Hostname to IP resolution
***** 69	TFTP	UDP		Basic version of FTP
***** 80	HTTP	TCP	HTTPS, 443	Transmit web page data
***** 88	Kerberos	TCP/UDP		Network Authentication using tickets
***** 110	POP3	TCP	POP3 w/ TLS, 995	Receives Email
***** 119	NNTP	TCP		Transport Usenet Articles
***** 135	RPC	TCP/UDP		Locate DCOM ports
***** 137-139	NetBIOS	TCP/UDP		Name querying, sending data, NetBIOS connection
***** 143	IMAP	TCP	IMAP4 w/ TLS, 993	Email retrieval
***** 161	SNMP	UDP		Remote network device monitoring
***** 162	SNMPTRAP	TCP/UDP		Traps/InformRequests sent to SNMP manager
***** 389	LDAP	TCP/UDP	LDAP w/ TLS, 636	Maintain user and other object directory
***** 445	SMB	TCP		Shared access to files and resources
***** 514	Syslog	UDP	Syslog w/ TLS, 6514	Computer message logging
***** 860	iSCSI	TCP		IP based protocol for linking data storage facilities
***** 1433	Ms-sql-s	TCP		Opens MS SQL server queries
***** 1701	L2TP	UDP		VPN protocol with no security, used with IPsec
***** 1723	PPTP	TCP/UDP		VPN protocol with security
***** 1813	RADIUS	UDP		AAA protocol for authentication, authorization and accounting
***** 3225	FCIP	TCP/UDP		Encapsulate Fibre channel frames
***** 3389	RDP	TCP/UDP		Remote Desktop Protocol for Windows
***** 3868	Diameter	TCP		AAA protocol that can replace RADIUS
** Malicious Attacks
*** DOS-Resource depletion attack
**** Flood Attack
***** Ping floods : Uses ICMP packets (disable ICMP to protect servers)
***** Smurf attack : Redirects ICMP echoes to spoofed IP
***** Fraggle : Redirect UDP echoes (port 7 and 19) to spoofed IP
***** SYN flood : sends large amount of TCP SYN packets to target
***** Xmas flood : Aims to reboot routers
**** Ping of Death
***** Sends oversized/malformed packets to crash services
***** Mostly automatically blocked by modern OSes
**** Teardrop Attack
***** Sends mangled IP fragments to crash IP reassembly code
**** Permanent DOS
***** Flashes custom images onto routers and network devices
**** Fork bomb
***** Forces numerous processes that saturates processor capacity
*** DDOS
**** Utilizes a botnet to flood and DOS a host
**** Common defenses similar to DOS defenses
**** ACL routers, firewall, IPS, simulated servers effective
**** DNS amplification â€“ another reflective spoofed IP attack
*** Sinkholes & Blackholes
**** Sinkhole : DNS server configured to give false data to bots Abused to maliciously redirect users to false sites
**** Blackhole : List of domains known to be malicious and blocked
*** Spoofing
**** Impersonation of various URI (Uniform Resource Identifier)
**** MitM attacks, IP spoofing, MAC spoofing, session hijacking etc
**** WWN spoofing : World Wide Names are unique identifiers to SAN (like MACs)/SAN (Storage Area Network)
*** Session Hijacking
**** Session Theft
***** Typical cookie hijacking in browser (application) level
***** Use different nonces for session keys & encryption
**** TCP/IP Hijacking
***** Predicts next sequence number in a TCP session to inject data
***** PKI encrypted traffic to counter TCP/IP Hijacking
**** Blind Hijacking
***** Randomly injects data hoping it works
**** Clickjacking
**** MitM
**** MitB (Man in the Browser)
***** Infected browser modifies user input data when packets are sent
***** Third party transaction verification and antivirus counters this
**** Watering Hole
***** Plants malicious code into high traffic sites
*** Replay Attacks
**** Attacker saves and reuses valid packets at a future date
**** Defenses
***** Session tokens, timestamping & synchronization, crypto and nonces
*** Null Session
**** Uses port 139 & 445 (NetBIOS and SMB)
**** Abuses built in unauthenticated connection enabled by default on old Windows
*** Transitive Access and Clientside Attacks
**** Compromising a trusted user of a server in turn compromises the server
**** 
*** DNS Poisoning
**** Improper modification of DNS information redirects users to malicious sites
**** Targets DNS server caches
**** Defenses : TLS, DNSSec, TSIG (Transaction Signature), Server patches
***** * Unauthorized zone transfers
***** Attacker gains quick reconnaissance by replicating DNS data
***** Gains various hostnames and IP addresses
**** Windows host files are also a common target
***** hosts file used to locally resolve hostname to IP addresses
***** When compromised can result in data leak or malicious redirection
***** When compromise detected delete and remake hosts file w/ read-only
**** Pharming : A poisoned DNS cache/hosts redirects users to malicious sites
**** Domain name kiting : Repeatedly reregistering domain name to use it for free
*** ARP Poisoning
**** ARP resolves IP to MAC addresses
**** Use VLAN segmentation and separation to minimize damage
* Chapter 8 : Network Perimeter Security
** Firewalls and Network Security
*** Firewalls
**** Prevents unwanted access to networks by blocking ports & IP
**** ACL (Access Control List) decide which packets to allow
**** Packet Filtering : Inspects and filters unwanted packets
***** Stateless : Does not keep track of previous packets
***** Stateful : Keeps a record of previous packets for cumulative filter
**** NAT Filtering : Filters according to matching inbound/outbound ports
**** Application Level Gateway : Security measures applied to a specific app
**** Circuit Level Gateway : Only checks if a connection is valid
***** Ignores validity of individual packets
**** Firewall Logging : Logs all connection and blocked packets
**** Types of Firewalls
***** Packet Filtering
****** Most basic form
****** Observes packet headers to see if they violate firewall rule
***** Stateful Firewalls
****** Keeps track of established sessions
****** Filters unwanted request to open new connections
***** Application Firewalls
****** Blocks or allows specific applications to communicate
***** Web App Firewalls
****** Specifically designed for HTTP sessions
*** Proxy Servers
**** Acts as an intermediary between LAN clients and outside servers
**** Types of Proxies
***** IP Proxy : Uses NAT to hide client IP address. Basic router function
***** Caching : Saves remote server data for efficiency
****** Commonly used in HTTP proxies
****** Disable PAC (proxy auto configuration) files 
***** Reverse : Protects LAN servers from outside clients
***** Application : Acts as a remote connection application
**** Proxies generally modify client requests for anonymity and security.
**** Those that do not modify client requests are called =transparent proxies=.
**** Internet Content Filtering : Can be installed on each host, but more efficient to install on a proxy
**** Web Security Gateways : Active monitoring and filtering of user data streams /UTM (Unified Threat Management)
*** Honeypots / Honeynets
**** Composed in various sizes (1 machine, file to a network of machines)
**** Used to study and analyze attacker behavior
*** DLP (Data Loss Prevention)
**** Stops leakage of confidential information through content inspection
**** Detects company confidential information and prevents it from exiting network
**** If data is stored on cloud/BYOD, cloud based DLP is more suitable
** NIDS vs NIPS
*** NIDS (Network Intrusion Detection System)
**** Attempts to detect malicious network activities (port scans, DDoS)
**** Common solutions : Snort (open source), Bro (open source)
**** Placed before a firewall, but also placed in key network locations
***** * Promiscuous mode on NIDS adapter allows examination of all network packets
**** Sometimes effective enough to remove most HIDS solutions
**** Pros 
***** Effective detection of network intrusion
***** Installed on only a few machines for whole network
**** Cons
***** Cannot read encrypted traffic
***** Cannot monitor individual machine
***** Passive (does not prevent attacks)
*** NIPS (Network Intrusion Prevention System)
**** Inspects packets and removes/redirects malicious traffic
**** Application aware device â€“ able to associate packets to specific applications
**** Pros 
***** Can protect non computer based network devices (routers, switches)
***** Prevent attackers from entering the network (Active)
***** Able to read encrypted traffic
**** Cons
***** Single point of failure, can bring down entire network if knocked out
***** Prone to false positive/negatives
***** Fail open/close
***** Uses more resources
*** Protocol Analyzer
**** Captures and analyzes packets, allowing inspection of packet content
*** UTM (Unified Threat Management)
**** Culmination of various network defenses in a single device
**** All-in-one device or NGFW (Next Generation Firewall)
**** Can also be a single point of failure
* Chapter 9 : Securing Network Media and Devices
** Wired Networks
*** Vulnerabilities
**** Various types of devices â€“ routers, switches, firewalls, NIDS/NIPS etc
**** Default Accounts
***** Default username/password of many devices are public knowledge
***** Make sure to change username/password before connecting device to web
**** Weak Passwords
**** Privilege Escalation
***** Escalation to kernel, DRM bypass, jailbreaking, malware etc
***** Vertical Privilege Escalation
****** Lower privilege accessing higher privilege, user  admin
***** Horizontal Privilege Escalation
****** User access function of another user, user1  user2
**** Backdoors
***** Bypasses traditional authentication, faulty code, RAT software/rootkit
**** Network Attacks
***** DOS/DDoS, Spoofing etc (refer to Ch 7)
*** Cable Media Vulnerabilities
**** Types of Cables
***** Twisted pair
***** Fiber optic
***** Coax
**** Electromagnetic / Radio Frequency Interference
***** Creates noise and unwanted signals, use cable shielding
**** Crosstalk
***** Wires placed in proximity affect one anotherâ€™s signals
***** Use twisted pair cables to minimize/eliminate crosstalk
***** NEXT (Near End Crosstalk)
****** Measurement of interference at the point closest to noise source
***** FEXT (Far End Crosstalk)
****** Measurement of interference at the point furthest from noise src 
**** Data Emanation
***** Data leakage through EM field generations (side channels)
***** Use shielded cables or faraday cages to prevent EM field
***** Refer to the US govt. TEMPEST guidelines
**** Wiretapping
***** Employing a butt set to RJ11/punch block
***** Plugging into open twisted pair ports on routers/switch/hub
***** Splitting twisted pair connections and cables
***** Spectral Analyzers to detect electric signals on cables
***** Passive optical splitter (fiber optics wiretapping)
**** Wiring Closets
***** IDF (Intermediate Distribution Frame) : one per each floor
***** MDF (Main Distribution Frame) : All IDFs connect to the MDF
******  One for building, connects to ISPs
***** SNMP monitored devices(PDU, UPS etc) can be used by attackers to bypass security measures to attack IDF/MDF
** Securing Wireless Networks
*** Vulnerabilities
**** Administration Interface(Romming)
***** Default username/password on administration consoles
**** SSID Broadcasting
***** Disable it under normal circumstances, enable only when connecting 
***** new device 
**** Rogue Access Point
***** Keep track of all legitimate access points with graphing tools
***** Investigate any undocumented AP showing up
**** Evil Twin
***** Rogue AP that uses same SSID as legitimate AP
***** Use VPN that requires another authentication step
**** Weak Encryption
***** Current standard is WPA2, PSK wireless transport layer security
****** Types of wireless encryption
******* WEP	Wired Equivalent Privacy (Deprecated)	64 bit
******* WPA	WiFi Protected Access	128 bit
******* WPA2	WiFi Protected Access version 2		256 bit
******* TKIP	Temporal Key Integrity Protocol (Deprecated)	128 bit
******* CCMP	Counter Mode with CBC-MAC Protocol	128 bit
******* AES	Advanced Encryption Standard	128/192/256 bit
******* WTLS	Wireless Transport Layer Security	Based on TLS
**** WPS (Wireless Protected Setup)
***** Should be disabled in all cases, can easily be brute forced and broken
**** Ad Hoc Networks
***** Wireless connection between clients without central control
***** Obviously massively insecure, should be disallowed in all cases
**** VPN over Open Wireless
***** All wireless VPN should be accompanied by suitable encryption protocol (PPTP, IPSec etc)
*** Wireless Access Point Security Strategy
**** Minimize external signal bleeding and employ EM shielding
**** Wireless site survey to gauge various signal strength / locate interference
**** Employ WAP built in firewall and NAT and MAC filtering if possible
**** AP isolation â€“ Segment each client on the WAP, prevent client-client comms
**** Encryption on application layer as well
**** WLAN controller to centralize WAP management
*** Wireless Transmission Attacks
**** War Driving/War chalking
**** IV attack
**** MAC Spoofing
**** Deauth
**** Dictionary/Brute Force WAP passwords
** Bluetooth and Other Devices
*** Bluetooth and NFC (Near Field Communicator) can also be an attack vector
*** Bluejacking : Unsolicited Bluetooth messages
*** Bluesnarfing : Unauthorized access of information from Bluetooth devices
*** RFID
**** Generally used in authentication
**** Up to date chips have better encryption and shielding, more secure
**** Uses very close range NFC (4 cm) to communicate/authenticate
*** Other Wireless Technologies
**** Cell Signals : Generally disabled within company premises
* Chapter 10 : Physical Security and Authentication Models
** Identification : Something that identifies a person
** Authentication : When a personâ€™s identity is confirmed or verified
** Authorization : When a user is given permission to access certain materials /Happens after authentication
** Physical Security
*** Perimeter security : Ample lighting, no hidden corners, CCTV/guards etc
*** Server Room
**** Position on elevated levels, avoid water damage
**** Cables and physical locks to deter theft/tampering
*** Door Access
**** Should be implemented according to local crime rate and data within
**** Use electronic keycards and cardkey controllers
***** Hardware based tokens and OTP generators also secure
**** Smart cards for authentication
***** PIV (Personal Identity Verification, government employees)
***** CAC (Common Access Card, DoD/military personnel) 
**** Also employ mantraps to avoid tailgating
*** Biometrics
**** Beware of false acceptance/rejection rates
**** Crossover Error Rate should be minimized
***** (When False Acceptance Rate = False Rejection Rate)
** Authentication Models and Components
*** Authentication Models
**** Username/Password
**** Multifactor Authentication (MFA), more secure but also costly
**** Context Aware Authentication
**** Single Sign On (SSO)
**** Federated Identity Management
**** Web based SSO
*** Localized Authentication Technology
**** Ways to authenticate users connecting to a LAN
**** 802.1X and EAP
***** Way of ensuring port security, uses data link layer protocols
***** 1.Authenticator detects new client, initiates 802.1X
****** 802.1X is often used as port layer security along with VLANs
***** 2.Authenticator sends EAP requests to new client, client responds with EAP responses which are forwarded to Authentication Server
***** 3.Authentication Server responds with request for an EAP method which is forwarded to the client
***** 4.EAP request/responses are sent between server and client until authentication is successful
****** Types of EAP Methods
******* EAP-MD5
******* EAP-TLS
******* EAP-TTLS
******* EAP-FAST
******* PEAP
**** LDAP (Lightweight Directory Access Protocol)
***** Used most often in MS Active Directory
***** Protocol used to access and maintain directory servers
***** Default port 389, SSL enabled secure port 636
**** Kerberos and Mutual Authentication
***** Used in client-server model for mutual authentication
***** Protection against eavesdropping/replay attacks
***** Builds off of symmetric key crypto and trusted third parties
***** Relies on a central server (could become single point of failure)
**** Remote Desktop Services
***** Remote control of a Windows machine from a client
***** Well known port, weak encryption, no multifactor authentication
***** More secure third party options exist, adding security costs $$$
*** Remote Authentication Servers
**** Examples : RAS, VPN, RADIUS, TACACS+, CHAP
**** RAS (Remote Access Service)
***** Def : Any combination of HW/SW that allows remote access tools
***** Common measures to secure RAS
****** Deny access to those who don't need it
****** Monitor daily usage logs
****** Set up RAS authentication
**** CHAP (Challenge-Handshake Authentication Protocol)
***** 1 â€“ Authenticator sends challenge to client
***** 2 â€“ Client responds with hash of challenge + secret(password)
***** 3 â€“ If correct maintain connection, else terminate
***** MS-CHAPv2 is recommended b/c it provides mutual authentication
**** VPN
***** Connects two computers through hostile network via tunneling
***** Common Protocols : PPTP, L2TP
***** VPN remote access vs Site to site configuration
****** Split Tunneling
******* Allows a client to connect to both WAN & LAN-via-VPN
******* May bypass higher level security measures placed on LAN
****** GRE(Generic Routing Encapsulation) by Cisco
******* Sometimes used to encapsulate PPTP/IPSec for VPN
**** RADIUS vs TACACS+
***** RADIUS
****** Provides centralized authentication for dialup VPN/wireless
****** EAP/802.1X compatible
****** Network of RADIUS servers called a federation is also used
***** TACACS+
****** Mainly used on UNIX environments as a daemon
* Chapter 11 : Access Control Methods and Models
** Access Control Models : How admission to physical areas and computer systems are managed
*** Discretionary Access Control (DAC)
**** Determined by owner of file/folder
**** Owner decides how each user/group accesses his file
*** Mandatory Access Control (MAC)
**** Strictest form of access control, need to know basis
**** Each user is given clearance level and can only access files within level
***** Eg) FOUO, Confidential, Secret, Top Secret
**** Rule based access control
***** Access determined by comparing label to clearance level
**** Lattice based access control
***** More complex, involves set mathematics
*** Role Based Access Control (RBAC)
**** Access controlled by a central authority
**** Various roles that have overlapping privileges are assigned to users
*** Attribute Based Access Control (ABAC)
**** Dynamic and context aware access control
*** Basic Access Control Practices
**** Implicit Deny
**** Least Privilege
**** Separation of Duties
**** Job Rotation
** Rights, Permissions and Policies
*** Users, Groups and Permissions
**** Windows Active Directory
***** Users can be added to specific OUs or Users folder
***** Logon times and valid login dates can also be configured
***** Consolidate multiple accounts with Federated Identity Management/SSO
***** Group users with similar permissions together
**** NTFS Permissions
***** Full Control
***** Modify
***** Read & Execute
***** List Folder Contents
***** Read
***** Write
**** Permission Inheritance and Propagation
***** Default behavior is child folder inherits parent folder permissions
***** Cannot change without disabling permission inheritance
***** Moving vs Copying data
****** Copy : Inherits permission of destination folder
****** Move : Retains original permission
**** Username and Passwords
***** Weak and old pw is common avenue for data exfiltration
***** Never use default username/pw for admin (or anything)
***** Disable guest and unnecessary accounts
***** Ctrl + Alt + Delete to log in, ensures users are using keyboard Vs network connection
***** Use policy management
**** Policies
***** Enforced rules configured either on individual machine or network
***** Password Policies
****** Enforce password history
****** Min - Max password age
****** Minimum pw length
****** Complexity requirements
***** Most are configured on OS level with AD domain controller
**** UAC (User Account Control)
***** By default keeps all non-admin users without full admin rights
* Chapter 12 : Vulnerability and Risk Assessment
** Conducting Risk Assessment
*** General Risk Management Strategies
**** Transfer risk to third party
**** Avoid the risk by not using specific tech/equipment
**** Reduce risk by minimizing damage and attack surface, implement defense
**** Accept the consequence
*** Risk Assessment
**** Identify company assets
**** Identify vulnerabilities
**** Identify threats and likelihood
**** Identify monetary impact
**** * Risk Register : Record of risk assessment, often referenced and updated
*** Qualitative vs Quantitative Risk Assessment
**** Qualitative Risk Assessment
***** Assigns numeric values to probability of risk and impact
***** Difficult to estimate exact values, must rely on history and survey
**** Quantitative Risk Assessment
***** Attempts to measure risk using exact monetary losses
***** Single Loss Expectancy (SLE)
***** Annual Rate of Occurrence (ARO)
***** Annual Loss Expectancy (ALE) = SLE X ARO
***** Mean time between failures (MTBF)
** Average # of failures in a million hours of operations
*** Active vs Passive Security Analysis (Active vs Passive Reconnaissance)
**** Active Security Analysis
***** Employs actual testing (may interfere with regular operations)
***** Active Scanning
**** Passive Security Analysis
***** Analyzing network documentation
***** Passive fingerprinting
*** Security Controls
**** Categorical
***** Management : Focus on executive level decisions and risk management
***** Operational : Focus on individuals
****** User awareness, incident handling, fault tolerance
***** Technical : Focus on the system, firewall configurations, IPS/IDS
**** Definitive
***** Preventative : Employed before an event, designed to prevent
***** Detective : Employed during an event to find malicious activity
***** Corrective : Employed after an event to minimize damage
*** Vulnerability Management
**** Five step process
***** Define a desired state of security
***** Create a baseline
***** Vulnerability prioritization
***** Mitigate vulnerability
***** Monitor environment
**** Penetration Testing
***** A demonstration of vulnerabilities found in step 3 through exploits
***** Black box (no knowledge), Gray box(limited knowledge), Glass box(full knowledge)
***** Pivot : Launching additional exploits after gaining network foothold
***** Persistence and Backdoors
***** Race Conditions
***** Basic Methodologies
****** OSSTMM
****** NIST PenTesting Standard
***** OVAL : Standardized secure transfer of information on security
** Assessing Vulnerabilities with Security Tools
*** Network Mapping
**** Draw out the physical and logical connections of the network
**** Use Network Topology Mapper
**** AirMagnet(WiFi)
**** Things to include in the diagram
***** Devices
***** IP Address
***** Role
***** Connections
*** Vulnerability Scanning
**** Nessus - Basic vulnerability scanner
**** Nmap - Basic port scanner
**** Network Enumeration and Banner Grabbing
*** Network Sniffing
**** Process of capturing and analyzing packets on a network
**** Wireshark - Basic packet analyzer
**** Fluke Networks - Hardware based network tester
**** Tcpdump for Unix/Linux
*** Password Analysis
**** Use password crackers to test strength of passwords
**** Cain and Abel - Basic password cracker
**** John the Ripper, Hydra, Aircrack-ng suite etc
**** Password Storage locations
***** Windows â€“ SAM hive, encrypted binary
***** Linux - /etc/passwd or /etc/shadow, encrypted
* Chapter 13 : Monitoring and Auditing
** Monitoring Methodologies
*** Focus on Automated Monitoring
**** Signature based monitoring
***** Matches predetermined attack patterns and packets/frames
***** Vulnerable to false negatives, need constant updates
**** Anomaly based monitoring
***** Establishes a baseline and detects deviations from this baseline
***** Inaccurate baseline leads to false positives
**** Behaviour based monitoring
***** Compare previous application behavior and detects current anomalies
***** Prone to false positive due to application diversity
** Using Tools to Monitor Systems and Networks
*** Performance Baselining
**** Baseline vs Baseline reporting
**** Security posture vs Security Poster Assessment
*** Protocol Analyzer
**** Promiscuous vs Non-promiscuous mode for network adapters
**** Broadcast Storm Analysis
**** Header Manipulation Detection
**** TCP Handshake Analysis
**** Wireshark : Promiscuous mode capturing vs port mirroring vs network tap
**** Tcpdump for Unix/Linux
*** SNMP (Simple Network Management Protocol)
**** TCP/IP, helps monitor network attached machines
**** Typical usage scenarios
***** Managed Devices
***** Agents
***** Network Management System
**** Inbound vs Outbound management
*** Analytical Tools
**** compmgmt.msc & openfiles, net file & suite/netstat (Windows)
**** lsof(list open files) & netstat (Linux)
**** Static and Dynamic Tools
***** Static : openfiles, netstat that takes snapshot of network
***** Dynamic : Task Monitor, wireshark that captures packets over time
*** Conducting Audits
**** Manual Assessment
***** Review of security logs, ACLs, user rights, permissions, group policy
***** Vulnerability scans
***** Personnel Interviews
**** Overall Process
***** Define audit target
***** Create backups
***** Scan, analyze and create a list of vulnerabilities/issues
***** Calculate risk
***** Develop a plan to minimize risk and fix issues
**** Auditing Files
***** Able to set auditing and logging for file, folder and user
***** Review logs to ensure non-repudiation & beware of permission hierarchy
**** Logging
***** compmgmt.msc in Windows allows viewing of security logs
***** Also pay attention to system and application logs
***** Syslog centralized log monitoring
**** Log File Maintenance and Security
***** Logfile size, configuration and encryption
***** Backups and manually clear log files
**** Auditing System Security Settings
***** Manage shared folders and user privileges in compmgmt.msc
* Chapter 14 : Encryption and Hashing Concepts
** Types of Data
*** Data in Use
*** Data at Rest
*** Data in Transit
** Symmetric vs Asymmetric Algorithms
*** Symmetric : Uses same key for encryption/decryption
**** ex) DES, AES, RC, Kerberos (Key distribution center)
**** Stream vs Block Cipher modes
**** Suited for large volumes of data, fast and efficient
*** Asymmetric : Uses different keys for encryption/decryption
****  ex)RSA, Diffie-Hellman, Elliptic curve
**** Public and private keys are created for asymmetric key scheme
** Key Management : Generation and secure storage of strong passwords
** Steganography : Art of hiding information in various file formats, usually image files
** Encryption Algorithms
*** DES/3DES
**** DES â€“ 64 bit block cipher with 56 bit key
**** 3DES â€“ 64 bit block cipher with 168 bit key
*** AES
**** 128 bit block size, variable key length (128, 192, 256 bit)
**** Current standard, fast and suited for hardware acceleration
*** RC
**** Widely used stream cipher, but vulnerable
**** Currently up to RC6
*** RSA 
**** 1024/2048 bit key size
**** Slow, suited for signing or specific encryption
**** Vulnerable to MitM attacks, reliant on PKI and digital certificates
*** Diffie-Hellman
**** Secure key exchange algorithm
**** Also vulnerable to MitM attack, reliant on authentication methods
**** Used in TLS
**** Can also employ Ephemeral keys (EDH) for perfect forward secrecy
*** Elliptic Curve Crypto (ECC)
**** Used in similar fashion to DH but faster and more compact
**** Can be adopted into other algorithms
**** Used in VoIP, IPSec
**** Vulnerable to side channel and fault injection
*** Other Encryption Algorithms
**** One time pads
***** Fast, theoretically perfect information secrecy
***** Practically dependent on security of PRNG
**** PGP
***** Uses various ciphers but mainly employs RSA
***** Requires same versions to communicate properly, limitation
**** PRNG
***** Written in C or Java for efficiency
***** Serves as a foundation for many cryptosystems
***** Weak PRNGs are often a vulnerability
**** Emerging : AI, Genetic algorithms and stylometry
** Hashing Basics
*** Provides message integrity
**** Cryptographic Hash Functions
***** MD5 
****** Used commonly for file integrity
****** Prone to MD5 hash collision attacks
***** SHA
****** Current standard is 256/512 bit SHA-2
***** RIPEMD & HMAC
***** LANMAN, NTLM, NTLMv2
****** Series of password hashing algorithms
****** LANMAN
******* Old Windows password hash based on DES
******* Deprecated and now considered a liability
******* Disable on either registry or local security policy
****** NTLM/NTLMv2
******* NTLM : Based on RC4, now broken
******* NTLMv2 : Based on HMAC-MD5 /However, most Windows opt to use Kerberos instead
**** Hashing Attacks
***** Pass the Hash
****** Uses the saved password hash value to create an authenticated session
****** Mostly targets Windows/Kerberos for SSO function abuse
****** Use unique session tokens, multifactor, least privilege
***** Birthday Attack
****** Attempt to create a message with hash collision to original message
****** Targets hashes with weak hash collision resistance
**** Additional hashing concepts
***** Key Stretching / Salting
* Chapter 15 : PKI and Encryption Protocols
** PKI (Public Key Infrastructure)
*** A system of trust that uses public key crypto to bind a certificate to an identity
*** Certificates
**** Digitally signed electronic documents that binds a public key with an entity
**** Mostly based on X.509 format to facilitate SSO
**** Contains the following
***** User information and public key
***** Certificate authority information
*** Name, digital signature, serial number, issue/expiration date
**** Mostly used for HTTPS connections, but can also be used for local encryption
**** Types of SSL Certificates
***** Domain Validation
***** Organizational Validation
***** Extended Validation
***** Wildcard Certificates
**** Single sided vs Double sided certificates
***** Single sided â€“ validates the server to its user/clients
***** Double sided â€“ Both server and user validates to each other
**** Certificate Chain of Trust
***** Used to validate different pieces of hardware & software
***** Also provides scalability and flexibility
**** Certificate Formats
***** Identifying certificate formats by extension and encoding
***** X.609 Encoding Rules
****** BER (Basic Encoding Rule)
****** CER (Canonical Encoding Rule)
****** DER (Distinguished Encoding Rule)
***** Certificate Formats and Extensions
****** PEM
******* ASCII encisioning and deprovisioningoded, contains â€œBegin/End Certificateâ€ stmts
******* .pem/.crt/.cer/.key extensions
******* Uses DER, .der is in pure binary
****** P12/PFX
******* Pure binary encoding
******* .pfx/.p12 extensions
******* Used to import/export certificates and private keys
**** Certificate Authorities
***** Entity : Server that issues certificates to users
***** Trust third party, often used in HTTPS connections
***** Clicking on HTTPS padlock allows one to view cert details
***** Invalid certs are placed on certification revocation list
***** SSL pinning â€“ attempts to prevent MitM
***** Online certificate status protocol
***** Key escrow
***** Key recovery agent
***** CA hierarchy w/ offline root CA
**** Web of Trust
***** Decentralized, self sign/publishing certificate system
***** Used by PGP
** Security Protocols
*** Overview
**** Email : S/MIME, PGP
**** Web Login		: SSL, TLS
**** Direct Conn.	: SSH
**** Virtual Conn.	: PPTP, L2TP
*** S/MIME
**** Used for authentication, message integrity and non-repudiation
**** Requires a digital ID certificate in MS Outlook to use
*** SSL/TLS
**** Used for secure internet communication such as browser, VoIP, email etc
**** Relies on PKI for obtaining and validating certificates
**** Asymmetric encryption (public key)  Symmetric encryption (session key)
**** Can employ SSL/TLS accelerator
**** Also heavily used in E-commerce in HTTPS
**** Downgrade attack (FREAK & DROWN)
*** SSH 
**** Uses public key crypto to establish remote authenticated connections
**** Also serves as basis for SFTP, SCP
*** PPTP, L2TP, IPSec
**** PPTP
***** Protocol used for VPNs
***** Supports PPP packets, designed for dial up but no security
***** Considered insecure in most cases
**** L2TP
***** By default has no encryption or security, but powerful when combined with IPSec
***** Uses PKI when installed on Windows servers
**** IPSec
***** Authenticates and encrypts IP packets
***** Operates on lower levels of OSI (Network)
***** Made of 3 different protocols
****** Security Association (SA)
****** Authentication header
****** Encapsulating Security Payload
***** 2 Modes of Implementation
****** Transport mode
******* Secure transfer of data, encrypted packet payload
******* Used within LAN or private network
****** Tunnel mode
******* Entire packet is encrypted
******* Facilitates VPN through internet
* Chapter 16 : Redundancy and Disaster Recovery
** Redundancy Planning
*** Redundancy is key to avoiding single points of failure
*** Redundant Power
**** Keep servers and networks alive in failures
**** Keep accessibility and minimize damage
**** Common electrical problems
***** Power Surges & Spikes
***** Sags, brownouts and blackouts
***** Power supply failure
**** Redundant Power Supplies
***** Enclosure that contains two or more power supplies
***** Common Vendors : HP, Cisco, Termaltake, Enlight
**** UPS(Uninterruptible Power Supplies)
***** Combined surge protector and backup battery (decoupling capacitors)
***** Cleans up dirty/noisy power like line conditioners
***** Considered temporary 5-30 min solution to resupply main or backup power
***** SPS(Standby power supply) vs UPS(Uninterruptible power supply)
**** Backup Generators
***** Serves as emergency power supply for an entire system
***** Standby Generators â€“ automatically operates in a power outage
***** Types of Generators
****** Portable Gas Engine
****** Permanently Installed
****** Battery Inverter
***** Considerations
****** Price
****** Manual vs Automatic Operation
****** Uptime / Capacity, Power Output
****** Fuel Source
***** Common Vendors : Generac, Gillette, Kohler
*** Redundant Data
**** RAID Arrays
***** RAID 0 â€“ Data Striping
***** RAID 1 â€“ Data Mirroring
**** RAID 5 â€“ Striping with parity
***** RAID 6 â€“ Striping with double parity
***** RAID 10 â€“ 2 RAID 1 mirrors striped
**** RAID Classification
***** a)Failure Resistant
***** b)Failure Tolerant
***** c)Disaster tolerant
***** * a < b < c in terms of protection scope
*** Redundant Networking
**** Server Network Adapters
***** Plan to install multiple redundant adapters
***** Consider centralized network adapter management software
**** Main switch/router connection
***** Always have spare switches/routers
***** Avoid pure star topologies and single points of failures
**** Internet Connection
***** Dual and redundant ISP internet connections
***** Consider mirror sites for web content
*** Redundant Servers
**** Goal : Minimize server downtime in failure and maximize throughput
**** Failover clusters
***** Designed so that secondary server takes over when primary fails
***** Provides high availability
**** Load balancing clusters
***** Several servers share CPU, RAM, hard disk resources
***** Commonly used in DNS, IRC and FTP servers
***** Can also employ failover measures by replicating data between servers
*** Redundant Sites (Physical locations)
**** Hot site â€“ Complete replication of entire network, servers & phone lines
**** Warm site â€“ Partial replication with some data recovery
**** Cold site â€“ Minimal equipment replication
*** Redundant people
**** Employ role takeover & primary/secondary personnel protocols
** Disaster Recovery Plans and Procedures
*** Data Backup
**** Tape Backup
***** Full backup
***** Incremental backup
***** Differential backup
**** Backup Schemes
***** 10 tape rotation
***** Grandfather-father-son scheme (Daily, weekly, monthly)
***** Tower of Hanos scheme
**** Snapshot backups
*** DR Planning
**** Types of Disasters
***** Fire
*****  Flood
***** Long term power loss
***** Theft and attack
***** Loss of building access
**** Disaster Recovery Plans
***** Only include necessary information
***** Things to Include
****** Contact Info
****** Impact Evaluation : Asset loss and replacement costs
****** Recovery Plan
****** Business continuity plan
****** Copies of various agreements
****** Disaster recovery drills
****** Critical system and data list
* Chapter 17 : Social Engineering, User Education and Facilities Security
** Social Engineering Scenarios
*** Pretexting
*** Malicious Insider
*** Diversion Theft
*** Phishing
**** Spearphishing
**** Whaling
*** Hoax
*** Shoulder Surfing
*** Eavesdropping
*** Dumpster Diving
*** Baiting
*** Piggybacking/tailgating
**** employ mantraps
*** Watering Hole attack
** Facilities Security
*** Fire Suppression
**** Fire extinguishers
***** Class A : Green Triangle: Solid combustibles
***** Class B : Red Square: Flammable liquid and gas
***** Class C : Blue Circle: Electrical (use CO2 extinguisher)
***** Class D : Yellow Decagon: Metals (Magnesium, lithium etc)
***** Class K : Black Hexagon: Cooking oil	
***** Currently most electronics friendly extinguisher use FE-36 Halotron
**** Sprinkler
***** Wet pipe : Most common type
***** Dry pipe : Supply water only when needed
***** Pre-Action : Prevents accidental water discharges
**** Special Hazard Protection Systems
***** Uses special liquid FM-200
***** Electronics safe
****  HVAC (Heating, Ventilation and Air Conditioning)
***** Manages temperature and humidity
***** Hot and cold aisles
***** SCADA Industrial Control Systems
**** Shielding
***** STP wires to prevent cable interference
***** HVAC shielding
***** Faraday cages
***** TEMPEST guidelines
*** Vehicles
**** Disable mobile tethering in vehicles
**** CAN (Control Area Network, vehicleâ€™s onboard network) vulnerabilities
**** GPS systems vulnerabilities
**** Airgapped Control Systems
**** Drones
* TODO shopping list [1/3] [33%]
   + [ ] eggs
   + [ ] milk
   + [X] oatmeal
*  
* TODO [#A] workout for 30min 
  SCHEDULED: <2021-03-11 Thu>
* TODO [#B] work in moms room 
  SCHEDULED: <2021-03-11 Thu 11:00>

